pytextmonitor
=============

Информация
----------

PyTextMonitor - минималистичный плазмоид, написанный на Python2. Он выглядит как виджеты в Awesome WM.

**ВНИМАНИЕ** [НУЖНЫ ПЕРЕВОДЧИКИ!](https://github.com/arcan1s/pytextmonitor/issues/14)

Настройка
---------

Для редактирования внешнего вида, откройте окно настроек и установите требуемый формат в поля:

* тег `$time` - время в стандартном формате. Например, *fri Nov 6 04:48:01 2013*
* тег `$isotime` - время в ISO формате
* тег `$shorttime` - время в коротком формате
* тег `$longtime` - время в длинном формате
* тег `$custom` - свой формат времени
* тег `$uptime` - время работы, *---d--h--m*
* тег `$custom` - свой формат аптайма
* тег `$cpu` - общая загрузка CPU, *%*
* тег `$cpuN` - загрузка CPU для ядра N, *%*
* тег `$cpucl` - средняя частота CPU, *MHz*
* тег `$cpuclN` - частота CPU для ядра N, *MHz
* тег `$tempN` - температура для устройства N. Например, `$temp0`
* тег `$gpu` - использование GPU, *%*. `aticonfig` или `nvidia-smi` должны быть установлены
* тег `$gputemp` - температура GPU. `aticonfig` или `nvidia-smi` должны быть установлены
* тег `$mem` - использование RAM, *%*
* тег `$memmb` - использование RAM, *MB*
* тег `$memgb` - использование RAM, *GB*
* тег `$memtotmb` - RAM, *MB*
* тег `$memtotgb` - RAM, *GB*
* тег `$swap` - swap, *%*
* тег `$swapmb` - swap, *MB*
* тег `$swapgb` - swap, *GB*
* тег `$swaptotmb` - размер swap, *MB*
* тег `$swaptotgb` - размер swap, *GB*
* тег `$hddN` - использование точки монтирования N, *%*. Например, `$hdd0`
* тег `$hddmbN` - использование точки монтирования N, *MB*. Например, `$hddmb0`
* тег `$hddgbN` - использование точки монтирования N, *GB*. Например, `$hddgb0`
* тег `$hddtotmbN` - размер точки монтирования N, *MB*. Например, `$hddtotmb0`
* тег `$hddtotgbN` - размер точки монтирования N, *GB*. Например, `$hddtotgb0`
* тег `$hddrN` - скорость записи на диск N, *KB/s*. Например, `$hddr0`
* тег `$hddwN` - скорость чтения с диска N, *KB/s*. Например, `$hddw0`
* тег `$hddtempN` - температура HDD N. Например, `$hddtemp0`
* тег `$down` - скорость загрузки, *KB/s*
* тег `$up` - скорость отдачи, *KB/s*
* тег `$netdev` - текущий сетевой интерфейс
* тег `$bat` - заряд батареи, *%*
* тег `$ac` - статус адаптера питания. Возвращает (\*), если AC подключен или *( )*, если нет
* тег `$album` - альбом. Один из поддерживаемых плееров должен быть установлен
* тег `$artist` - исполнитель. Один из поддерживаемых плееров должен быть установлен
* тег `$progress` - прогресс. Один из поддерживаемых плееров должен быть установлен
* тег `$time` - длительность. Один из поддерживаемых плееров должен быть установлен
* тег `$title` - название. Один из поддерживаемых плееров должен быть установлен
* тег `$pscount` - число запущенных процессов
* тег `$pstotal` - общее число процессов
* тег `$ps` - список процессов
* тег `$pkgcountN` - число пакетов, которые могут быть обновлены, для команды N. Например, `$pkgcount0`
* тег `$customN` - возвращает результат своей команды N. Например, `$custom0`
* тег `$name` - имя текущего рабочего стола
* тег `$number` - номер текущего рабочего стола
* тег `$total` - общее число рабочих столов

Порядок полей изменится, если вы измените позицию слайдеров. HTML теги в полях работают корректно.

**ЗАМЕЧАНИЕ** вы не можете установить тег `$cpu`, например, в поле swap. **`$cpu` будет работать только в поле CPU**.

Советы и хитрости
-----------------

Вы можете использовать различные цвета в полях. Просто вставьте нужный текст в html код. Смотри [вопрос](https://github.com/arcan1s/pytextmonitor/issues/9) для более подробной информации.

Нумерация элементов в полях "Температура", "Использование HDD", "Скорость HDD", "Температура HDD" ссылается на порядок элементов во второй вкладке (*Расширенные настройки*). Вы должны сначала добавить требуемые элементы в нужный listWidget. И первый элемент в listWdiget будет связан c `$tag0`. Смотри [вопрос](https://github.com/arcan1s/pytextmonitor/issues/17) для более подробной информации.

Расширенные настройки
---------------------

**Включить фон**

Снимите галочку, чтобы отключить стандартный фон виджета и установить прозрачный.

**Вертикальная разметка**

Использовать вертикальную разметку вместо горизонтальной.

**Включить всплывающие сообщения**

Нажмите на чекбокс, если вы не используете всплывающие сообщения.

**Добавить пустое пространство**

Добавить пустое пространство в указанное место виджета.

**Свой формат времени**

* тег `$dddd` - день недели в длинном формате
* тег `$ddd` - день недели в коротком формате
* тег `$dd` - день
* тег `$d` - день без нуля
* тег `$MMMM` - месяц в длинном формате
* тег `$MMM` - месяц в коротком формате
* тег `$MM` - месяц
* тег `$M` - месяц без нуля
* тег `$yyyy` - год
* тег `$yy` - год в коротком формате
* тег `$hh` - часы
* тег `$h` - часы без нуля
* тег `$mm` - минуты
* тег `$m` - минуты без нуля
* тег `$ss` - секунды
* тег `$s` - секунды без нуля

**Свой формат аптайма**

* тег `$dd` - дни аптайма
* тег `$d` - дни аптайма без нуля
* тег `$hh` - часы аптайма
* тег `$h` - часы аптайма без нуля
* тег `$mm` - минуты аптайма
* тег `$m` - минуты аптайма без нуля

**Температурные единицы**

Выберите единицы температуры. Доступные единицы следующие: Цельсий, Фаренгейт и Кельвин.

**Датчики температуры**

Список датчиков, которые будут наблюдаться в поле temo (содержимое комбо бокса берется из `sensors`). Виджет редактируем, клавиша delete удалит текущую строку.

**Точки монтирования**

Список точек монтирования, которые будут наблюдаться в поле hdd (содержимое комбо бокса берется из `mount`). Виджет редактируем, клавиша delete удалит текущую строку.

**HDD (скорость)**

Список HDD, которые будут наблюдаться в поле hddspeed (содержимое комбо бокса берется из DataEngine). Виджет редактируем, клавиша delete удалит текущую строку.

**HDD (температура)**

Список HDD, которые будут наблюдаться в поле hddtemp (содержимое комбо бокса берется из `find`). Виджет редактируем, клавиша delete удалит текущую строку.

**Директория с сетевыми интерфейсами**

Путь к директории, которая содержит информацию о сетевых интерфейсах. По умолчанию `/sys/class/net`. Требуется для определения сетевого устройства.

**Сетевое устройство**

Использовать указанный интерфейс, как активный. Содержимое комбо бокса берется из **директории с сетевыми интерфейсами**. Эта опция отключит автоопределение интерфейса.

**Устройство батареи**

Файл с информацией о батарее. Данный файл (`/sys/class/power_supply/BAT0/capacity` по умолчанию) должен содержать только заряд батареи в процентах.

**AC online тег**

Строка, которая будет показана, когда AC онлайн.

**AC offline тег**

Строка, которая будет показана, когда AC оффлайн.

**Устройство AC**

Файл с информацией об адаптере питания. Данный файл (`/sys/class/power_supply/AC/online` по умолчанию) должен содержать `1`, если адаптер подключен.

Настройки тултипа
-----------------

Начиная с версии 1.7.0 поля "CPU", "Частота CPU", "Память", "Swap" и "Сеть" поддерживают графический тултип. Чтобы включить их, просто сделайте требуемые чекбоксы полностью чекнутыми. Число хранимых значений может быть выставленно в данной вкладке. Цвета графиков также настраиваются.

Настройки DataEngine
--------------------

**Своя команда**

*ЗАМЕЧАНИЕ* Может вызвать зависание компьютера.

Команды, которые будут запущены для соответствующего поля.

**Комадна для определения рабочего стола**

Введите команду, которая будет запущеная для desktop DataEngine. По умолчанию `qdbus org.kde.kwin /KWin currentDesktop`.

**Устройство GPU**

Выберите одно из поддерживаемых устройств GPU. `auto` включит автоматическое определение, `disable` отключит все мониторы GPU. По умолчанию `auto`.

**HDD**

Выберете один из HDD для монитора его температуры. `all` включит монитор для всех доступных устройств, `disable` отключит определение температуры HDD. По умолчанию `all`.

**Команда hddtemp**

Введите команду, которая будет запущена для hddtemp DataEngine. По умолчанию `sudo hddtemp`.

**Адрес MPD**

Адрес MPD сервера. По умолчанию `localhost`.

**Порт MPD**

Порт MPD сервера. По умолчанию `6600`.

**Package manager**

Список команд, которые будут запущены. Число пустых строк - число ненужных для подсчета строк. Стандартные настройки:

* *Arch*: `PKGCMD=pacman -Qu`, `PKGNULL=0`
* *Debian*: `PKGCMD=apt-show-versions -u -b`, `PKGNULL=0`
* *Ubuntu*: `PKGCMD=aptitude search '~U'`, `PKGNULL=0`
* *Fedora*: `PKGCMD=yum list updates`, `PKGNULL=3`
* *FreeBSD*: `PKGCMD=pkg_version -I -l '<'`, `PKGNULL=0`
* *Mandriva*: `PKGCMD=urpmq --auto-select`, `PKGNULL=0`

**Музыкальный плеер**

Выберите один из поддерживаемых музыкальных плееров.

PTM desktop panel
=================

Начиная с версии 1.11.0 PyTextMonitor предоставляет минималистичную панель для мониторинга за рабочими столами, написанный на `C++`. И да, он выглядит, как аналогичная панель в Awesome.

Настройка Desktop panel
-----------------------

**Включить фон**

Снимите галочку, чтобы отключить стандартный фон виджета и установить прозрачный.

**Вертикальная разметка**

Использовать вертикальную разметку вместо горизонтальной.

**Добавить пустое пространство**

Добавить пустое пространство в указанное место виджета.

**Метка**

Введите символ (или строку), которая будет показана, если данный рабочий стол сейчас активен.

**Теги шаблона**

* тег `$mark` - показать метку, если данный рабочий стол активен
* тег `$name` - имя рабочего стола
* тег `$number` - номер рабочего стола
* тег `$total` - общее число рабочих столов

**Команда**

Введите команду, которая будет запущена по клику левой кнопкой мыши на выбранном рабочем столе. Доступны те же переменные, что и для шаблонов. По умолчанию `dbus org.kde.kwin /KWin setCurrentDesktop $number`.

Инструкция
==========

Зависимости
-----------

* kdebase-workspace
* kdebindings-python2
* lm_sensors (*для определения датчиков температуры*)

Опциональные зависимости
------------------------

* sysstat (*для уведомлений*)
* проприетарный видеодрайвер
* hddtemp (убедитесь, что может быть запущен с `sudo` без пароля. Просто добавьте следующую строку в `/etc/sudoers`: `$USERNAME ALL=NOPASSWD: /usr/bin/hddtemp`)
* музыкальный плеер (amarok, clementine, mpd или qmmp)

Зависимости сборки
------------------

* automoc4
* cmake

Установка
---------

* скачать исходный архив
* установить

        mkdir build && cd build
        cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=`kde4-config --localprefix` ../
        make && make install

  Для установки в `/`:

        mkdir build && cd build
        cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=`kde4-config --prefix` ../
        make && sudo make install

Дополнительная информация
=========================

TODO (wish list)
----------------

Ссылки
------

* [Домашняя страница](http://arcanis.name/projects/pytextmonitor/)
* Виджет на [kde-look](http://kde-look.org/content/show.php/Py+Text+Monitor?content=157124)
* DataEngine на [kde-look](http://kde-look.org/content/show.php/Extended+Systemmonitor+DataEngine?content=158773)
* Пакет для Archlinux в [AUR](https://aur.archlinux.org/packages/kdeplasma-applets-pytextmonitor/)
